## <font style="background-color:rgba(255, 255, 255, 0);">cookie、JWT、session 的原理和区别</font>
+ **<font style="background-color:rgba(255, 255, 255, 0);">原理</font>**
    - **<font style="background-color:rgba(255, 255, 255, 0);">cookie</font>**<font style="background-color:rgba(255, 255, 255, 0);">：是服务器发送到用户浏览器并保存在本地的一小段数据。服务器在响应中设置</font>`<font style="background-color:rgba(255, 255, 255, 0);">Set - Cookie</font>`<font style="background-color:rgba(255, 255, 255, 0);">头部，浏览器会将其存储。之后，浏览器在每次请求同一域名下的资源时，会自动在请求头中带上相应的</font>`<font style="background-color:rgba(255, 255, 255, 0);">Cookie</font>`<font style="background-color:rgba(255, 255, 255, 0);">字段，服务器通过解析</font>`<font style="background-color:rgba(255, 255, 255, 0);">Cookie</font>`<font style="background-color:rgba(255, 255, 255, 0);">来识别用户身份等信息。</font>
    - **<font style="background-color:rgba(255, 255, 255, 0);">JWT</font>**<font style="background-color:rgba(255, 255, 255, 0);">：由服务器对用户信息进行加密签名后生成一个包含用户相关信息的 JSON 对象。客户端在登录成功后收到 JWT，之后每次请求时，将 JWT 放在请求头的</font>`<font style="background-color:rgba(255, 255, 255, 0);">Authorization</font>`<font style="background-color:rgba(255, 255, 255, 0);">字段中发送给服务器，服务器通过验证 JWT 的签名和有效性来识别用户身份和权限。</font>
    - **<font style="background-color:rgba(255, 255, 255, 0);">session</font>**<font style="background-color:rgba(255, 255, 255, 0);">：服务器在用户登录时为其创建一个唯一的会话（session），并将用户信息存储在服务器端的内存或数据库中。同时，服务器会向客户端发送一个</font>`<font style="background-color:rgba(255, 255, 255, 0);">session ID</font>`<font style="background-color:rgba(255, 255, 255, 0);">，通常通过</font>`<font style="background-color:rgba(255, 255, 255, 0);">Cookie</font>`<font style="background-color:rgba(255, 255, 255, 0);">来传递。客户端后续请求时，会携带这个</font>`<font style="background-color:rgba(255, 255, 255, 0);">session ID</font>`<font style="background-color:rgba(255, 255, 255, 0);">，服务器根据</font>`<font style="background-color:rgba(255, 255, 255, 0);">session ID</font>`<font style="background-color:rgba(255, 255, 255, 0);">来查找对应的用户信息，以实现用户身份的识别和状态的保持。</font>
+ **<font style="background-color:rgba(255, 255, 255, 0);">区别</font>**
    - **<font style="background-color:rgba(255, 255, 255, 0);">存储位置</font>**<font style="background-color:rgba(255, 255, 255, 0);">：cookie 存储在客户端浏览器中；JWT 通常也存储在客户端（如本地存储或</font>`<font style="background-color:rgba(255, 255, 255, 0);">Cookie</font>`<font style="background-color:rgba(255, 255, 255, 0);">中）；session 存储在服务器端。</font>
    - **<font style="background-color:rgba(255, 255, 255, 0);">数据传输</font>**<font style="background-color:rgba(255, 255, 255, 0);">：cookie 会在每次请求和响应中自动携带，可能会增加不必要的传输数据量；JWT 需要客户端在请求头中手动携带，且其大小相对固定，不会随请求次数增加而增大；session 只在客户端发送</font>`<font style="background-color:rgba(255, 255, 255, 0);">session ID</font>`<font style="background-color:rgba(255, 255, 255, 0);">，服务器根据</font>`<font style="background-color:rgba(255, 255, 255, 0);">session ID</font>`<font style="background-color:rgba(255, 255, 255, 0);">查询相关信息，数据传输量较小。</font>
    - **<font style="background-color:rgba(255, 255, 255, 0);">安全性</font>**<font style="background-color:rgba(255, 255, 255, 0);">：cookie 容易被篡改，若不设置</font>`<font style="background-color:rgba(255, 255, 255, 0);">HttpOnly</font>`<font style="background-color:rgba(255, 255, 255, 0);">属性，还可能受到 XSS 攻击；JWT 由于有签名验证，相对安全，但如果密钥泄露则存在风险；session 的安全性主要依赖于服务器对</font>`<font style="background-color:rgba(255, 255, 255, 0);">session ID</font>`<font style="background-color:rgba(255, 255, 255, 0);">的管理和保护，一般较为安全。</font>
    - **<font style="background-color:rgba(255, 255, 255, 0);">跨域支持</font>**<font style="background-color:rgba(255, 255, 255, 0);">：cookie 在跨域场景下存在限制，需要进行复杂的配置和处理；JWT 可以方便地在不同域之间传递，只要各方都能验证 JWT 的有效性；session 在跨域时也需要额外的处理，如通过设置</font>`<font style="background-color:rgba(255, 255, 255, 0);">CORS</font>`<font style="background-color:rgba(255, 255, 255, 0);">等。</font>

## <font style="background-color:rgba(255, 255, 255, 0);">JWT 的组成</font>
<font style="background-color:rgba(255, 255, 255, 0);">JWT 本质上就是一组字串，通过（</font>**<font style="background-color:rgba(255, 255, 255, 0);">.</font>**<font style="background-color:rgba(255, 255, 255, 0);">）切分成三个为 Base64 编码的部分：</font>

+ **<font style="background-color:rgba(255, 255, 255, 0);">Header（头部）</font>**<font style="background-color:rgba(255, 255, 255, 0);"> </font><font style="background-color:rgba(255, 255, 255, 0);">: 描述 JWT 的元数据，定义了生成签名的算法以及</font><font style="background-color:rgba(255, 255, 255, 0);"> </font>`<font style="background-color:rgba(255, 255, 255, 0);">Token</font>`<font style="background-color:rgba(255, 255, 255, 0);"> </font><font style="background-color:rgba(255, 255, 255, 0);">的类型。Header 被 Base64Url 编码后成为 JWT 的第一部分。</font>
+ **<font style="background-color:rgba(255, 255, 255, 0);">Payload（载荷）</font>**<font style="background-color:rgba(255, 255, 255, 0);"> </font><font style="background-color:rgba(255, 255, 255, 0);">: 用来存放实际需要传递的数据，包含声明（Claims），如</font>`<font style="background-color:rgba(255, 255, 255, 0);">sub</font>`<font style="background-color:rgba(255, 255, 255, 0);">（subject，主题）、</font>`<font style="background-color:rgba(255, 255, 255, 0);">jti</font>`<font style="background-color:rgba(255, 255, 255, 0);">（JWT ID）。Payload 被 Base64Url 编码后成为 JWT 的第二部分。</font>
+ **<font style="background-color:rgba(255, 255, 255, 0);">Signature（签名）</font>**<font style="background-color:rgba(255, 255, 255, 0);">：服务器通过 Payload、Header 和一个密钥(Secret)使用 Header 里面指定的签名算法（默认是 HMAC SHA256）生成。生成的签名会成为 JWT 的第三部分。</font>

<font style="background-color:rgba(255, 255, 255, 0);">JWT 通常是这样的：</font>`<font style="background-color:rgba(255, 255, 255, 0);">xxxxx.yyyyy.zzzzz</font>`<font style="background-color:rgba(255, 255, 255, 0);">。</font>

## <font style="background-color:rgba(255, 255, 255, 0);">JWT 的 payload 里存了什么信息</font>
<font style="background-color:rgba(255, 255, 255, 0);">JWT（JSON Web Token）的 payload 部分是 JWT 的核心内容，主要存放以下几类信息：</font>

+ **<font style="background-color:rgba(255, 255, 255, 0);">声明（Claims）</font>**<font style="background-color:rgba(255, 255, 255, 0);">：这是 payload 的主要部分，包含了各种关于用户或实体的信息。例如，</font>`<font style="background-color:rgba(255, 255, 255, 0);">sub</font>`<font style="background-color:rgba(255, 255, 255, 0);">（subject）用于标识用户身份，</font>`<font style="background-color:rgba(255, 255, 255, 0);">name</font>`<font style="background-color:rgba(255, 255, 255, 0);">表示用户名，</font>`<font style="background-color:rgba(255, 255, 255, 0);">email</font>`<font style="background-color:rgba(255, 255, 255, 0);">代表用户邮箱等。还可以包含一些自定义的声明，用于传递特定业务相关的信息，如用户角色、权限等。</font>
+ **<font style="background-color:rgba(255, 255, 255, 0);">过期时间（Expiration Time）</font>**<font style="background-color:rgba(255, 255, 255, 0);">：通过</font>`<font style="background-color:rgba(255, 255, 255, 0);">exp</font>`<font style="background-color:rgba(255, 255, 255, 0);">字段来指定 JWT 的过期时间，以 Unix 时间戳表示。这可以确保令牌在一定时间后失效，增强安全性。</font>
+ **<font style="background-color:rgba(255, 255, 255, 0);">签发时间（Issued At）</font>**<font style="background-color:rgba(255, 255, 255, 0);">：由</font>`<font style="background-color:rgba(255, 255, 255, 0);">iat</font>`<font style="background-color:rgba(255, 255, 255, 0);">字段表示，记录 JWT 的签发时间，用于验证令牌的新鲜度。</font>

